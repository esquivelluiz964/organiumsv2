{% extends 'base.html' %}
{% block title %}Ticket #{{ ticket.id }} - Ajuda{% endblock %}
{% block content %}

<h1>{{ ticket.titulo }}</h1>
<p>Status: {{ ticket.status }}</p>

<div class="chat-box">
    {% for msg in ticket.mensagens %}
        <div class="chat-msg {% if current_user.is_authenticated and msg.usuario_id == current_user.id %}msg-self{% else %}msg-other{% endif %}">
            <div class="chat-author">{{ msg.usuario.name if msg.usuario else "An√¥nimo" }}</div>
            <div class="chat-text">{{ msg.conteudo }}</div>
            <div class="timestamp">{{ msg.criado_em.strftime('%d/%m %H:%M') }}</div>
        </div>
    {% endfor %}
</div>

<form method="POST">
    {% if not current_user.is_authenticated %}
        <input type="text" name="nome" placeholder="Digite seu nome" required>
    {% endif %}
    <textarea name="conteudo" placeholder="Digite sua mensagem..." required></textarea>
    <button type="submit">Enviar</button>
</form>

{% endblock %}
